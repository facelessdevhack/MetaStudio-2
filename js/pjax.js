var animating=false,saveScrollTop=0,lastElementClicked,elTop,elHeight,elName,pTimer,timeout=3000,prevUrl;if(device==="pc"){Barba.Pjax.init();Barba.Prefetch.init()}var pageTransition=Barba.BaseTransition.extend({start:function(){$html.addClass("is_basic transition");TweenLite.set(".prgoress",{width:0});TweenLite.set(".transitionPanel, .movett",{clip:"rect(0px "+windowW+"px "+windowH+"px 0px)"});TweenLite.set(".blind",{width:"100%",alpha:0,backgroundColor:"#090909"});TweenLite.to(".blind",0.5,{alpha:1,ease:Circ.easeInOut});Promise.all([this.newContainerLoading,this.enterNewPage()]).then(this.showNewPage.bind(this)).then(this.finish.bind(this))},enterNewPage:function(){var c=this;var a=Barba.Utils.deferred();var b=$(this.newContainer);if(!pTimer){pTimer=setTimeout(a.resolve,timeout)}setTimeout(function(){var d=imagesLoaded(b,{background:true}),e=0;d.on("progress",function(f,h){e++;var g=e/f.images.length;c.newPageProgress(g)}),d.on("always",a.resolve)},300);return a.promise},showNewPage:function(){if(pTimer){clearTimeout(pTimer);pTimer=null}this.newPageProgress(1);$html.addClass("ready");TweenLite.set(scrollWindow,{scrollTo:0})},finish:function(){reset();this.done();TweenLite.set(".movett",{clip:"rect(0px "+windowW+"px "+windowH+"px 0px)"});loading.complete(1.2)},newPageProgress:function(a){clearTimeout(pTimer);TweenLite.to(".prgoress",1,{width:a*100+"%",ease:Sine.easeInOut})},newPageProgress:function(a){clearTimeout(pTimer);TweenLite.to(".prgoress",1,{width:a*100+"%",ease:Sine.easeInOut})}});var worksTransition=Barba.BaseTransition.extend({start:function(){var d=this;TweenLite.set(".blind",{width:0,alpha:1,backgroundColor:"#fff"});TweenLite.set(".transitionPanel",{clip:"rect(0px "+windowW+"px "+windowH+"px 0px)"});var a=$(lastElementClicked).offset().top;var c=$(lastElementClicked).height();var b=a+c/2-windowH/2;TweenLite.to(scrollWindow,0.6,{scrollTo:b,ease:Power1.easeOut,onComplete:function(){saveScrollTop=$(scrollWindow).scrollTop();$html.addClass("is_godetail transition");Promise.all([d.newContainerLoading,d.enterNewPage()]).then(d.showNewPage.bind(d)).then(d.finish.bind(d))}})},enterNewPage:function(){var e=this;var b=Barba.Utils.deferred();var d=$(this.newContainer);if(!pTimer){pTimer=setTimeout(function(){slider.work();b.resolve()},timeout)}var a=imagesLoaded(d,{background:true}),c=0;a.on("progress",function(f,h){c++;var g=c/f.images.length;e.newPageProgress(g)}),a.on("always",function(f){$(".work_slider ul").on("init",b.resolve);slider.work()});return b.promise},showNewPage:function(){this.newPageProgress(1)},finish:function(){if(pTimer){clearTimeout(pTimer);pTimer=null}var a=this;$(".work_slider ul").trigger("resize");if(prevUrl){$(".btn_close").attr("href",prevUrl)}TweenLite.to(".focusedThumb .cat",0.5,{height:0,ease:Circ.easeInOut,onComplete:function(){TweenLite.to(".focusedThumb .title",0.6,{height:0,ease:Power4.easeInOut});reset();a.done();loading.complete(0)}})},newPageProgress:function(a){TweenLite.to(".workProgress",0.8,{width:a*100+"%",ease:Circ.easeInOut});TweenLite.to(".blind",0.8,{width:a*100+"%",ease:Circ.easeInOut})}});var careerTransition=Barba.BaseTransition.extend({start:function(){TweenLite.set(".blind",{width:0,alpha:1,backgroundColor:"#090909"});TweenLite.set(".transitionPanel",{clip:"rect(0px "+windowW+"px "+windowH+"px 0px)"});if($(lastElementClicked).is(".b_dark")){TweenLite.set(".blind",{backgroundColor:"#090909"})}else{TweenLite.set(".blind",{backgroundColor:"#ffffff"})}saveScrollTop=$(scrollWindow).scrollTop();$html.addClass("is_goint transition");TweenLite.to(".blind",1,{width:"100%",ease:Circ.easeInOut});Promise.all([this.newContainerLoading,this.enterNewPage()]).then(this.finish.bind(this))},enterNewPage:function(){var c=this;var a=Barba.Utils.deferred();var b=$(this.newContainer);setTimeout(function(){a.resolve()},600);return a.promise},finish:function(){TweenLite.set(scrollWindow,{scrollTo:0});reset();this.done();loading.complete(0)}});var loadmoreTransition=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.enterNewPage.bind(this)]).then(this.finish.bind(this))},enterNewPage:function(){var a=Barba.Utils.deferred();TweenLite.to(".works_list",0.6,{autoAlpha:0,y:-40,ease:Circ.easeOut,onComplete:function(){effect.titleIn();effect.typewriterFire();if(!pTimer){pTimer=setTimeout(a.resolve,timeout)}var b=imagesLoaded({background:true}),c=0;b.on("progress",function(d,f){c++;var e=c/d.images.length}),b.on("always",a.resolve)}});return a.promise},finish:function(){TweenLite.set(scrollWindow,{scrollTo:0});this.done();loading.complete(0);TweenMax.fromTo(".works_list",2,{y:windowH},{y:0,delay:0,ease:Quint.easeInOut})}});var goback=Barba.BaseTransition.extend({start:function(){var c=$(scrollWindow).scrollTop();var a=this.oldContainer;var b=$(a).height();$html.addClass("is_goback");TweenLite.set(a,{height:b,y:-c,clip:"rect(0px "+windowW+"px "+b+"px 0px)"});Promise.all([this.newContainerLoading,this.enterNewPage()]).then(this.finish.bind(this))},enterNewPage:function(){var a=Barba.Utils.deferred();BaseSplash=setTimeout(function(){a.resolve()},100);return a.promise},finish:function(){var d=this;var a=this.oldContainer;var c=this.newContainer;var b=$(a).height();this.newContainer.style.visibility="visible";TweenLite.set(scrollWindow,{scrollTo:saveScrollTop});reset();pageH=$(".page_wrapper").height();TweenLite.to(a,1,{clip:"rect(0px "+windowW+"px "+b+"px "+windowW+"px)",ease:Power4.easeInOut,onComplete:function(){d.done();saveScrollTop=0;effect.titleIn();loading.pageStart()}})}});Barba.Dispatcher.on("linkClicked",function(a){lastElementClicked=a;elTop=$(a).offset().top;elHeight=$(a).height();elName=a.getAttribute("data-namespace")}),Barba.HistoryManager.storeNamespace=function(a){this._namespace=a},Barba.PjaxpreventCheck=function(a,b){if(!window.history.pushState){return false}if(!b||!b.href){return false}if(a.which>1||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey){return false}if(b.target&&b.target==="_blank"){return false}if(window.location.protocol!==b.protocol||window.location.hostname!==b.hostname){return false}if(Utils.getPort()!==Utils.getPort(b.port)){return false}if(b.href.indexOf("#")>-1){return false}if(Utils.cleanLink(b.href)==Utils.cleanLink(location.href)){return false}if(b.classList.contains(this.ignoreClassLink)){return false}if(animating){animating=true;return false}return true},Barba.Pjax.getTransition=function(){var d=Barba.Pjax.History.prevStatus(),f=Barba.Pjax.History.currentStatus(),a=Barba.HistoryManager.history;var e=d.namespace;var b=f.namespace||elName||setCurrentNamespace();prevUrl=d.url;if(device!="pc"){return pageTransition}if(e==="detailpage"){return goback}else{if(e==="listpage"&&b==="detailpage"){return worksTransition}else{if(e==="listpage"&&b==="listpage"){return loadmoreTransition}else{if(e==="subpage"&&b==="detailpage"){return careerTransition}else{return pageTransition}}}}},Barba.Dispatcher.on("initStateChange",function(a){ga("send","pageview",location.pathname)}),Barba.Dispatcher.on("newPageReady",function(c,a,b){size();init(c.namespace);$("html").removeClass("new-office")}),Barba.Dispatcher.on("transitionCompleted",function(b,a){elName=null;animating=false});var setCurrentNamespace=function(a,d){var b=Barba.Pjax.History.currentStatus().url;var a=Barba.HistoryManager.history;for(i=0;i<a.length;i++){if(a[i].url===b){return a[i].namespace}return false}};